import requests
import sys

target: str = sys.argv[1]
file: str = sys.argv[2]
header: str = sys.argv[3]
payload_list: str = sys.argv[4]

def send_payloads():
    print('[*] Sending payloads...')

    try:
        stream_reader = open(payload_list, 'r')
    except FileNotFoundError:
        print('[-] Payload List does not exist, or cannot be found!')
        sys.exit(1)

    for payload in stream_reader:
        res = requests.get(f'https://{target}/{file}', params={f'{header}': payload})

        print('='*100)
        print(f'[*] PAYLOAD: {payload}', end='')
        print(f'[*] URL: {res.url}')
        print(f'[*] Response Code: {res.status_code}')

send_payloads()